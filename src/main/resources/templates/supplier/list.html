<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/main :: layout(~{::section})}">

<section>

    <h2 class="mb-4 d-flex justify-content-between align-items-center">
        <span>廠商清單</span>
        <div sec:authorize="hasAnyRole('MANAGER')" class="mt-3">
            <a class="btn btn-sm btn-dark" th:href="@{/suppliers/create}">
                新增
            </a>
        </div>
    </h2>

    <nav class="navbar bg-body-tertiary">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <form class="d-flex mb-0 flex-grow-1 me-3" 
                  th:action="@{/suppliers}" 
                  method="get" 
                  role="search">
    
                <input class="form-control me-2" 
                       type="search" 
                       placeholder="廠商編號/名稱/聯絡人/電話" 
                       aria-label="Search" 
                       name="q"
                       th:value="${q}" />
                <button class="btn btn-outline-success" type="submit">search</button>
                <a class="btn btn-clear"
                   th:href="${enalbed == null} ? @{/suppliers/status}" >Clear</a>
            </form>
    
            <div class="dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <span th:text="${enabled == null ? '狀態：全部' : (enabled ? '狀態：啟用' : '狀態：停用')}">
                        狀態：全部
                    </span>
                </a>
                
                <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                        <a class="dropdown-item" 
                           th:classappend="${enabled == null} ? ' active' : ''" 
                           th:href="@{/suppliers/status}">
                           全部
                        </a>
                    </li>

                    <li>
                        <a class="dropdown-item" 
                           th:classappend="${enabled == true} ? ' active' : ''" 
                           th:href="@{/suppliers/status(enabled=true)}">
                        啟用
                        </a>
                    </li>

                    <li>
                        <a class="dropdown-item" 
                           th:classappend="${enabled == false} ? ' active' : ''" 
                           th:href="@{/suppliers/status(enabled=false)}">
                            停用
                        </a>
                    </li>
                </ul>
            </div>
           
        </div>
    </nav>

    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
            <thead>
                <tr>
                    <th>廠商編號</th>
                    <th>名稱</th>
                    <th>聯絡人</th>
                    <th>電話</th>
                    <th>Email</th>
                    <th>啟用</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <!-- 空狀態 -->
                <tr th:if="${suppliers == null or suppliers.totalElements == 0}">
                    <td colspan="7" class="text-center text-muted">
                        查無供應商供應商資料
                    </td>
                </tr>

                <!-- 有資料 -->
                <tr th:each="supplier : ${suppliers.content}">
                    <td th:text="${supplier.supplierId()}"></td>
                    <td th:text="${supplier.supplierName()}"></td>
                    <td th:text="${supplier.contactName()}"></td>
                    <td th:text="${supplier.phone()}"></td>
                    <td th:text="${supplier.email()}"></td>
                    <td>
                        <span th:text="${supplier.enabled()} ? '是' : '否'"></span>
                    </td>
                    <td>
                        <a class="btn btn-sm btn-outline-dark"
                            th:href="@{/suppliers/{id}(id=${supplier.supplierId()})}">
                            詳情
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div th:replace="~{fragments/pagination :: pagination(${suppliers}, '/suppliers', ${q}, ${enabled}, ${null}, ${null})}"></div>

</section>

</html>